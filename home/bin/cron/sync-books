#!/usr/bin/env bash
# * */4 * * * $HOME/bin/sync-books
# journalctl -t cron-books

exec 1> >(logger -p user.info -t cron-books)
exec 2> >(logger -p user.err -t cron-books)

BOOKS_DIR="$HOME/books"

RESYNC=
if [[ ! -d "$BOOKS_DIR" ]]; then
	mkdir -p "$BOOKS_DIR"
	RESYNC=1
fi

# use --resync on first run
rclone bisync "$BOOKS_DIR" gdrive:books \
	--drive-use-trash \
	--log-level=INFO \
	--human-readable \
	--stats-one-line \
	${RESYNC:+--resync}
