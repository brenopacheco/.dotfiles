#!/usr/bin/env bash


function preview() {
    ID=$(echo $1)
    # tmux capture-pane -pt $WINDOWID
    echo $ID
}

export -f preview

RESULT=$(tmux list-sessions -F '#{session_name}(#{window_id}): #{window_name}' |\
    column -t | fzf --reverse --header "Switch session" --preview 'preview {}')



if [[ -z "$RESULT" ]]; then 
    exit 0
fi


SESSION=$(echo "$RESULT" | sed "s/^\(\S\+\):.*/\1/")
WINDOWID=$(echo "$RESULT" | sed "s/.*(\([0-9]\+\))/\1/")
ID=$RANDOM

echo "$SESSION"
echo "$WINDOW"
echo "$ID"

exit 1

tmux new -d -s tmp-$ID -t $SESSION \; select-window -t $WINDOW

if [[ -z "$TMUX" ]]; then
    tmux attach -t tmp-$ID:$WINDOW
else
    tmux switch-client -t tmp-$ID:$WINDOW
fi

# vim:tw=78:ts=8:noet:ft=sh:norl:
